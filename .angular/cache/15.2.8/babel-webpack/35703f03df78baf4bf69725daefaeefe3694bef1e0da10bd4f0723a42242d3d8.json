{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/reservaciones.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction HacerReservacionComponent_div_4_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i_r6);\n  }\n}\nfunction HacerReservacionComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"h2\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h2\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"br\");\n    i0.ɵɵelementStart(6, \"h5\");\n    i0.ɵɵtext(7, \"Ingresa los datos para hacer tu reservacion\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"br\");\n    i0.ɵɵelementStart(9, \"label\");\n    i0.ɵɵtext(10, \"Ano de la reservacion: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"input\", 3);\n    i0.ɵɵlistener(\"ngModelChange\", function HacerReservacionComponent_div_4_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.ano = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"br\")(13, \"br\");\n    i0.ɵɵelementStart(14, \"label\");\n    i0.ɵɵtext(15, \"Mes de la reservacion:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"select\", 4);\n    i0.ɵɵlistener(\"ngModelChange\", function HacerReservacionComponent_div_4_Template_select_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.mesSeleccionado = $event);\n    });\n    i0.ɵɵtemplate(17, HacerReservacionComponent_div_4_option_17_Template, 2, 1, \"option\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"br\")(19, \"br\");\n    i0.ɵɵelementStart(20, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function HacerReservacionComponent_div_4_Template_button_click_20_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.continuar());\n    });\n    i0.ɵɵtext(21, \"Continuar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(22, \"br\")(23, \"br\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Lugar: \", ctx_r0.casaNombre, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"Usuario: \", ctx_r0.usuario.nombre, \" \", ctx_r0.usuario.apellido, \"\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.ano);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.mesSeleccionado);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.meses);\n  }\n}\nfunction HacerReservacionComponent_div_5_option_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i_r12);\n  }\n}\nfunction HacerReservacionComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"label\");\n    i0.ɵɵtext(2, \"Selecciona uno de los dias disponibles\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"br\");\n    i0.ɵɵelementStart(4, \"select\", 4);\n    i0.ɵɵlistener(\"ngModelChange\", function HacerReservacionComponent_div_5_Template_select_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.dia = $event);\n    });\n    i0.ɵɵtemplate(5, HacerReservacionComponent_div_5_option_5_Template, 2, 1, \"option\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"br\")(7, \"br\");\n    i0.ɵɵelementStart(8, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function HacerReservacionComponent_div_5_Template_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.continuar2());\n    });\n    i0.ɵɵtext(9, \"Seleccionar fecha\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"br\")(11, \"br\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.dia);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.dias);\n  }\n}\nfunction HacerReservacionComponent_h5_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"h5\", 7);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"innerHTML\", ctx_r2.msj, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction HacerReservacionComponent_div_7_label_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\");\n    i0.ɵɵtext(1, \"Seleccione la fecha del checkout:\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction HacerReservacionComponent_div_7_button_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function HacerReservacionComponent_div_7_button_5_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r18 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r18.continuar3());\n    });\n    i0.ɵɵtext(1, \"Continuar\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction HacerReservacionComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, HacerReservacionComponent_div_7_label_1_Template, 2, 0, \"label\", 1);\n    i0.ɵɵelementStart(2, \"input\", 8);\n    i0.ɵɵlistener(\"ngModelChange\", function HacerReservacionComponent_div_7_Template_input_ngModelChange_2_listener($event) {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.fechaCheckOut = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"br\")(4, \"br\");\n    i0.ɵɵtemplate(5, HacerReservacionComponent_div_7_button_5_Template, 2, 0, \"button\", 9);\n    i0.ɵɵelement(6, \"br\")(7, \"br\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.seleccionarFechaCheckOut);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"max\", ctx_r3.limiteCheckOut);\n    i0.ɵɵpropertyInterpolate(\"min\", ctx_r3.fechaMinCheckOut);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.fechaCheckOut);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.seleccionarFechaCheckOut);\n  }\n}\nfunction HacerReservacionComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"br\")(2, \"br\");\n    i0.ɵɵelementStart(3, \"h1\", 10);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"br\");\n    i0.ɵɵelementStart(6, \"h3\", 10);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"br\");\n    i0.ɵɵelementStart(9, \"h5\");\n    i0.ɵɵtext(10, \"Fecha de CheckIn: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(11, \"br\")(12, \"h5\", 11)(13, \"br\")(14, \"br\");\n    i0.ɵɵelementStart(15, \"h5\");\n    i0.ɵɵtext(16, \"Fecha de CheckOut: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(17, \"br\")(18, \"h5\", 11);\n    i0.ɵɵelementStart(19, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function HacerReservacionComponent_div_8_Template_button_click_19_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.terminar());\n    });\n    i0.ɵɵtext(20, \"Volver al menu.\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"Felicidades \", ctx_r4.usuario.nombre, \"!\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Has hecho reservacion en \", ctx_r4.casaNombre, \".\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"innerHTML\", ctx_r4.fechaCheckIn.toLocaleDateString(), i0.ɵɵsanitizeHtml);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"innerHTML\", ctx_r4.fechaCheckOut.toLocaleDateString(), i0.ɵɵsanitizeHtml);\n  }\n}\nexport let HacerReservacionComponent = /*#__PURE__*/(() => {\n  class HacerReservacionComponent {\n    constructor(reservacionesService, router) {\n      this.reservacionesService = reservacionesService;\n      this.router = router;\n      this.title = 'calendarioEjemplo';\n      this.meses = [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"];\n      this.disponibles = [];\n      this.des = [];\n      this.dias = [];\n      this.casaID = \"\";\n      this.casaNombre = \"\";\n      this.seleccionarDia = false;\n      this.seleccionarFechaCheckOut = false;\n      this.mostrarFechas = false;\n      this.error = false;\n      this.msj = \"\";\n      this.fechaMinCheckOut = `${new Date().getFullYear()}-${(new Date().getMonth() + 1).toString().padStart(2, '0')}-${new Date().getDate().toString().padStart(2, '0')}`;\n      if (localStorage.getItem(\"casaNombre\") != null) {\n        this.casaNombre = JSON.parse(localStorage.getItem(\"casaNombre\") || \"\");\n      } else {\n        this.casaNombre = \"Casa 1\";\n      }\n      if (localStorage.getItem(\"casaID\") != null) {\n        this.casaID = JSON.parse(localStorage.getItem(\"casaID\") || \"\");\n      } else {\n        this.casaID = \"airbnb1\";\n      }\n      if (localStorage.getItem(\"usuarioActual\") != null) {\n        this.usuario = JSON.parse(localStorage.getItem(\"usuarioActual\") || \"\");\n      } else {\n        this.usuario = {\n          nombre: \"\",\n          apellido: \"\",\n          contrasena: \"\",\n          correo: \"\",\n          nacimiento: new Date(),\n          telefono: \"\"\n        };\n      }\n      this.des = reservacionesService.fechasOcupadas(this.casaID);\n      console.log(this.des.values);\n      this.ano = new Date().getFullYear();\n      this.mes = new Date().getMonth();\n      this.dia = new Date().getDate();\n      this.mesSeleccionado = this.meses[this.mes];\n      if (this.des != null) {\n        this.des.sort(function (a, b) {\n          return a.getTime() - b.getTime();\n        });\n      }\n    }\n    continuar() {\n      this.mes = this.meses.indexOf(this.mesSeleccionado);\n      if (this.ano == new Date().getFullYear() && this.mes >= new Date().getMonth() || this.ano > new Date().getFullYear()) {\n        this.error = false;\n        let ini = new Date(this.ano, this.mes, 1);\n        let fin = new Date(this.ano, this.mes + 1, 1);\n        this.seleccionarDia = true;\n        while (ini < fin) {\n          let band = true;\n          if (this.des != null) {\n            for (let i of this.des) {\n              if (ini.getDate() == i.getDate() && ini.getMonth() == i.getMonth() && ini.getFullYear() == i.getFullYear()) {\n                band = false;\n              }\n            }\n          }\n          if (band) {\n            this.dias.push(ini.getDate());\n          }\n          ini.setDate(ini.getDate() + 1);\n        }\n      } else {\n        this.seleccionarDia = false;\n        this.msj = \"Verifica el ano y mes ingresados\";\n        this.error = true;\n      }\n      //console.log(this.dias)\n    }\n\n    continuar2() {\n      if (new Date(this.ano, this.mes, this.dia) >= new Date()) {\n        this.error = false;\n        this.seleccionarFechaCheckOut = true;\n        this.fechaCheckIn = new Date(this.ano, this.mes, this.dia);\n        this.fechaMinCheckOut = `${this.fechaCheckIn.getFullYear()}-${(this.fechaCheckIn.getMonth() + 1).toString().padStart(2, '0')}-${this.fechaCheckIn.getDate().toString().padStart(2, '0')}`;\n        let min = this.minFechaCheckOut();\n        //console.log(min);\n        if (min == this.fechaCheckIn) {\n          min.setFullYear(min.getFullYear() + 1);\n        }\n        this.limiteCheckOut = `${min.getFullYear()}-${(min.getMonth() + 1).toString().padStart(2, '0')}-${min.getDate().toString().padStart(2, '0')}`;\n        //console.log(this.limiteCheckOut);\n        this.fechaCheckIn.setFullYear(this.fechaCheckIn.getFullYear() - 1);\n      } else {\n        this.msj = \"Verifica el dia ingresado\";\n        this.error = true;\n      }\n    }\n    minFechaCheckOut() {\n      this.des.push(this.fechaCheckIn);\n      //console.log(this.des);\n      this.des.sort(function (a, b) {\n        return a.getTime() - b.getTime();\n      });\n      //console.log(this.des);\n      let indice = this.des.indexOf(this.fechaCheckIn);\n      //console.log(indice + \" \" + this.des.length);\n      if (indice + 1 < this.des.length) {\n        let min = this.des[indice + 1];\n        return min;\n      }\n      return this.fechaCheckIn;\n    }\n    continuar3() {\n      this.reservacionActual = {\n        correo: this.usuario.correo,\n        checkin: new Date(this.fechaCheckIn),\n        checkout: new Date(this.fechaCheckOut)\n      };\n      const response = this.reservacionesService.anadirReservacion(this.reservacionActual, this.casaID);\n      console.log(response);\n      setTimeout(() => {\n        this.fechaCheckOut = new Date(this.fechaCheckOut);\n        this.mostrarFechas = true;\n      }, 3000);\n    }\n    terminar() {\n      localStorage.removeItem(\"casaNombre\");\n      localStorage.removeItem(\"casaID\");\n      this.router.navigate(['']);\n    }\n  }\n  HacerReservacionComponent.ɵfac = function HacerReservacionComponent_Factory(t) {\n    return new (t || HacerReservacionComponent)(i0.ɵɵdirectiveInject(i1.ReservacionesService), i0.ɵɵdirectiveInject(i2.Router));\n  };\n  HacerReservacionComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HacerReservacionComponent,\n    selectors: [[\"app-hacer-reservacion\"]],\n    decls: 9,\n    vars: 5,\n    consts: [[1, \"contenedor\"], [4, \"ngIf\"], [\"id\", \"error\", 3, \"innerHTML\", 4, \"ngIf\"], [\"type\", \"number\", 3, \"ngModel\", \"ngModelChange\"], [3, \"ngModel\", \"ngModelChange\"], [4, \"ngFor\", \"ngForOf\"], [3, \"click\"], [\"id\", \"error\", 3, \"innerHTML\"], [\"type\", \"date\", 3, \"max\", \"ngModel\", \"min\", \"ngModelChange\"], [3, \"click\", 4, \"ngIf\"], [\"id\", \"feli\"], [3, \"innerHTML\"]],\n    template: function HacerReservacionComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\");\n        i0.ɵɵtext(2, \"Hacer reservacion.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(3, \"br\");\n        i0.ɵɵtemplate(4, HacerReservacionComponent_div_4_Template, 24, 6, \"div\", 1);\n        i0.ɵɵtemplate(5, HacerReservacionComponent_div_5_Template, 12, 2, \"div\", 1);\n        i0.ɵɵtemplate(6, HacerReservacionComponent_h5_6_Template, 1, 1, \"h5\", 2);\n        i0.ɵɵtemplate(7, HacerReservacionComponent_div_7_Template, 8, 5, \"div\", 1);\n        i0.ɵɵtemplate(8, HacerReservacionComponent_div_8_Template, 21, 4, \"div\", 1);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", !ctx.mostrarFechas);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.seleccionarDia && !ctx.mostrarFechas);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.error);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.seleccionarFechaCheckOut && !ctx.mostrarFechas);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.mostrarFechas);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgModel],\n    styles: [\".contenedor[_ngcontent-%COMP%]{width:64%;padding:3%;align-items:center;margin:5% 15%;border:1px black solid;border-radius:1vw}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h5[_ngcontent-%COMP%]{width:100%;text-align:center}label[_ngcontent-%COMP%], input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{width:40%;margin-left:30%;margin-right:30%;text-align:center}#error[_ngcontent-%COMP%]{color:#9f0000}#feli[_ngcontent-%COMP%]{color:#005a00}\"]\n  });\n  return HacerReservacionComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}